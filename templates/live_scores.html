<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>賽事比分 - 籃球分析系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes pulse-dot {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.1); }
        }
        .live-dot {
            animation: pulse-dot 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            box-shadow: 0 0 10px #ef4444;
        }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }

        /* LoL Esports 風格的卡片 */
        .match-card {
            background: linear-gradient(135deg, rgba(17, 24, 39, 0.8) 0%, rgba(31, 41, 55, 0.6) 100%);
            border: 1px solid rgba(75, 85, 99, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .match-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transition: left 0.5s;
        }

        .match-card:hover::before {
            left: 100%;
        }

        .match-card:hover {
            border-color: rgba(139, 92, 246, 0.5);
            box-shadow: 0 8px 32px rgba(139, 92, 246, 0.15);
            transform: translateY(-2px);
        }

        /* 標籤頁樣式 */
        .tab-button {
            position: relative;
            padding: 12px 24px;
            transition: all 0.3s ease;
        }

        .tab-button::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: transparent;
            transition: background 0.3s ease;
        }

        .tab-button.active::after {
            background: linear-gradient(90deg, #8b5cf6, #ec4899);
        }

        .tab-button.active {
            color: #fff;
            font-weight: 600;
        }

        /* Live 標籤動畫 */
        @keyframes live-badge {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            50% { box-shadow: 0 0 0 8px rgba(239, 68, 68, 0); }
        }

        .live-badge {
            animation: live-badge 2s infinite;
        }

        /* 比分數字漸變 */
        .score-gradient {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* 日期選擇器 */
        .date-selector {
            background: rgba(17, 24, 39, 0.5);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="bg-gray-950 text-white">
    <!-- 導航欄 -->
    <nav class="gradient-bg shadow-lg sticky top-0 z-50 backdrop-blur-md bg-opacity-95">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <a href="/" class="bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg transition flex items-center space-x-2 backdrop-blur-sm border border-white/20">
                        <i class="fas fa-arrow-left"></i>
                        <span>返回首頁</span>
                    </a>
                </div>
                <h1 class="text-2xl font-bold">賽事中心</h1>
                <div class="flex items-center space-x-2">
                    <span class="bg-red-500 w-2.5 h-2.5 rounded-full live-dot"></span>
                    <span class="text-sm font-semibold">LIVE</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- 日期與標籤頁選擇器 -->
    <section class="sticky top-16 z-40 date-selector border-b border-gray-800">
        <div class="container mx-auto px-6">
            <!-- 日期選擇 -->
            <div class="flex items-center justify-center py-4 space-x-2">
                <button onclick="changeDate('prev')" class="p-2 hover:bg-gray-800 rounded-lg transition">
                    <i class="fas fa-chevron-left text-gray-400"></i>
                </button>
                <div class="flex space-x-1">
                    <button onclick="selectDate(0)" class="date-btn px-4 py-2 text-sm text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition">11/4 週一</button>
                    <button onclick="selectDate(1)" class="date-btn px-4 py-2 text-sm text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition">11/5 週二</button>
                    <button onclick="selectDate(2)" class="date-btn px-4 py-2 text-sm bg-purple-600 rounded-lg font-semibold">11/6 今天</button>
                    <button onclick="selectDate(3)" class="date-btn px-4 py-2 text-sm text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition">11/7 週四</button>
                    <button onclick="selectDate(4)" class="date-btn px-4 py-2 text-sm text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition">11/8 週五</button>
                </div>
                <button onclick="changeDate('next')" class="p-2 hover:bg-gray-800 rounded-lg transition">
                    <i class="fas fa-chevron-right text-gray-400"></i>
                </button>
            </div>

            <!-- 標籤頁 -->
            <div class="flex space-x-8 overflow-x-auto">
                <button onclick="switchTab('all')" class="tab-button active text-gray-400 whitespace-nowrap">
                    全部賽事
                </button>
                <button onclick="switchTab('live')" class="tab-button text-gray-400 whitespace-nowrap">
                    <span class="bg-red-500 w-2 h-2 rounded-full inline-block mr-2 live-dot"></span>
                    進行中 <span class="ml-1 text-xs">(2)</span>
                </button>
                <button onclick="switchTab('upcoming')" class="tab-button text-gray-400 whitespace-nowrap">
                    即將開始 <span class="ml-1 text-xs">(1)</span>
                </button>
                <button onclick="switchTab('finished')" class="tab-button text-gray-400 whitespace-nowrap">
                    已結束 <span class="ml-1 text-xs">(2)</span>
                </button>
            </div>
        </div>
    </section>

    <!-- 賽事列表 -->
    <section class="container mx-auto px-6 py-8 max-w-5xl">
        <div class="space-y-3">

            <!-- 進行中的比賽 -->
            <div class="match-card rounded-xl overflow-hidden">
                <!-- 頂部狀態列 -->
                <div class="bg-gradient-to-r from-red-600/20 to-orange-600/20 border-b border-red-500/30 px-6 py-3">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <span class="bg-red-500 text-white text-xs px-2.5 py-1 rounded font-bold live-badge">LIVE</span>
                            <span class="text-sm text-gray-300">NBA · 例行賽</span>
                        </div>
                        <span class="text-sm font-mono text-red-400 font-bold">Q4 02:34</span>
                    </div>
                </div>

                <!-- 比賽內容 -->
                <div class="p-6">
                    <div class="grid grid-cols-[1fr,auto,1fr] gap-6 items-center">
                        <!-- 主隊 -->
                        <div class="flex items-center space-x-4">
                            <img src="https://via.placeholder.com/60" alt="Lakers" class="w-14 h-14 rounded-lg border-2 border-gray-700">
                            <div class="flex-1">
                                <h3 class="text-lg font-bold">洛杉磯湖人</h3>
                                <p class="text-xs text-gray-500">Lakers</p>
                            </div>
                        </div>

                        <!-- 比分 -->
                        <div class="text-center px-6">
                            <div class="flex items-center space-x-4">
                                <span class="text-4xl font-black score-gradient">108</span>
                                <span class="text-2xl text-gray-600 font-light">:</span>
                                <span class="text-4xl font-black text-gray-400">105</span>
                            </div>
                        </div>

                        <!-- 客隊 -->
                        <div class="flex items-center space-x-4 justify-end">
                            <div class="flex-1 text-right">
                                <h3 class="text-lg font-bold">金州勇士</h3>
                                <p class="text-xs text-gray-500">Warriors</p>
                            </div>
                            <img src="https://via.placeholder.com/60" alt="Warriors" class="w-14 h-14 rounded-lg border-2 border-gray-700">
                        </div>
                    </div>

                    <!-- 各節比分 -->
                    <div class="mt-6 pt-6 border-t border-gray-800">
                        <div class="grid grid-cols-5 gap-3 text-center text-sm">
                            <div>
                                <div class="text-xs text-gray-500 mb-2">Q1</div>
                                <div class="font-semibold text-gray-300">28 - 25</div>
                            </div>
                            <div>
                                <div class="text-xs text-gray-500 mb-2">Q2</div>
                                <div class="font-semibold text-gray-300">26 - 28</div>
                            </div>
                            <div>
                                <div class="text-xs text-gray-500 mb-2">Q3</div>
                                <div class="font-semibold text-gray-300">27 - 24</div>
                            </div>
                            <div>
                                <div class="text-xs text-gray-500 mb-2">Q4</div>
                                <div class="font-semibold text-yellow-400">27 - 28</div>
                            </div>
                            <div>
                                <div class="text-xs text-gray-500 mb-2">總分</div>
                                <div class="font-bold score-gradient">108 - 105</div>
                            </div>
                        </div>
                    </div>

                    <!-- 操作按鈕 -->
                    <div class="mt-6 flex space-x-3">
                        <button class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 py-3 rounded-lg font-semibold transition flex items-center justify-center space-x-2">
                            <i class="fas fa-play-circle"></i>
                            <span>觀看直播</span>
                        </button>
                        <button class="px-6 bg-gray-800 hover:bg-gray-700 rounded-lg transition">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                    </div>
                </div>
            </div>


            <!-- 進行中比賽 2 (簡化版) -->
            <div class="match-card rounded-xl overflow-hidden">
                <div class="bg-gradient-to-r from-red-600/20 to-orange-600/20 border-b border-red-500/30 px-6 py-3">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <span class="bg-red-500 text-white text-xs px-2.5 py-1 rounded font-bold live-badge">LIVE</span>
                            <span class="text-sm text-gray-300">NBA · 例行賽</span>
                        </div>
                        <span class="text-sm font-mono text-red-400 font-bold">Q3 08:12</span>
                    </div>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-[1fr,auto,1fr] gap-6 items-center">
                        <div class="flex items-center space-x-4">
                            <img src="https://via.placeholder.com/60" alt="Celtics" class="w-14 h-14 rounded-lg border-2 border-gray-700">
                            <div class="flex-1">
                                <h3 class="text-lg font-bold">波士頓塞爾提克</h3>
                                <p class="text-xs text-gray-500">Celtics</p>
                            </div>
                        </div>
                        <div class="text-center px-6">
                            <div class="flex items-center space-x-4">
                                <span class="text-4xl font-black score-gradient">95</span>
                                <span class="text-2xl text-gray-600 font-light">:</span>
                                <span class="text-4xl font-black text-gray-400">89</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4 justify-end">
                            <div class="flex-1 text-right">
                                <h3 class="text-lg font-bold">邁阿密熱火</h3>
                                <p class="text-xs text-gray-500">Heat</p>
                            </div>
                            <img src="https://via.placeholder.com/60" alt="Heat" class="w-14 h-14 rounded-lg border-2 border-gray-700">
                        </div>
                    </div>
                    <div class="mt-6 flex space-x-3">
                        <button class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 py-3 rounded-lg font-semibold transition flex items-center justify-center space-x-2">
                            <i class="fas fa-play-circle"></i>
                            <span>觀看直播</span>
                        </button>
                        <button class="px-6 bg-gray-800 hover:bg-gray-700 rounded-lg transition">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                    </div>
                </div>
            </div>


            <!-- 即將開始的比賽 -->
            <div class="match-card rounded-xl overflow-hidden">
                <div class="bg-gradient-to-r from-blue-600/10 to-cyan-600/10 border-b border-blue-500/20 px-6 py-3">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <span class="bg-blue-600 text-white text-xs px-2.5 py-1 rounded font-bold">
                                <i class="fas fa-clock mr-1"></i>19:30
                            </span>
                            <span class="text-sm text-gray-300">NBA · 例行賽</span>
                        </div>
                        <span class="text-xs text-gray-500">45 分鐘後</span>
                    </div>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-[1fr,auto,1fr] gap-6 items-center">
                        <div class="flex items-center space-x-4">
                            <img src="https://via.placeholder.com/60" alt="Nets" class="w-14 h-14 rounded-lg border-2 border-gray-700 opacity-80">
                            <div class="flex-1">
                                <h3 class="text-lg font-bold">布魯克林籃網</h3>
                                <p class="text-xs text-gray-500">Nets</p>
                            </div>
                        </div>
                        <div class="text-center px-6">
                            <span class="text-2xl text-gray-600 font-bold">VS</span>
                        </div>
                        <div class="flex items-center space-x-4 justify-end">
                            <div class="flex-1 text-right">
                                <h3 class="text-lg font-bold">芝加哥公牛</h3>
                                <p class="text-xs text-gray-500">Bulls</p>
                            </div>
                            <img src="https://via.placeholder.com/60" alt="Bulls" class="w-14 h-14 rounded-lg border-2 border-gray-700 opacity-80">
                        </div>
                    </div>
                    <div class="mt-6">
                        <button class="w-full bg-gray-800 hover:bg-gray-700 py-3 rounded-lg font-semibold transition text-gray-300">
                            設定提醒 <i class="fas fa-bell ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 已結束的比賽 -->
            <div class="match-card rounded-xl overflow-hidden">
                <div class="bg-gradient-to-r from-gray-700/10 to-gray-600/10 border-b border-gray-700/30 px-6 py-3">
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-400">NBA · 例行賽 · 已結束</span>
                        <span class="text-xs text-gray-600">2 小時前</span>
                    </div>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-[1fr,auto,1fr] gap-6 items-center">
                        <div class="flex items-center space-x-4">
                            <img src="https://via.placeholder.com/60" alt="Clippers" class="w-14 h-14 rounded-lg border-2 border-gray-800 opacity-60">
                            <div class="flex-1">
                                <h3 class="text-base font-bold text-gray-400">洛杉磯快艇</h3>
                                <p class="text-xs text-gray-600">Clippers</p>
                            </div>
                        </div>
                        <div class="text-center px-6">
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl font-bold text-gray-500">112</span>
                                <span class="text-gray-700">-</span>
                                <span class="text-2xl font-bold text-gray-300">118</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4 justify-end">
                            <div class="flex-1 text-right">
                                <h3 class="text-base font-bold">丹佛金塊</h3>
                                <p class="text-xs text-gray-600">Nuggets</p>
                            </div>
                            <img src="https://via.placeholder.com/60" alt="Nuggets" class="w-14 h-14 rounded-lg border-2 border-gray-800">
                        </div>
                    </div>
                    <div class="mt-6">
                        <button class="w-full bg-gray-800 hover:bg-gray-700 py-2.5 rounded-lg font-semibold transition text-sm text-gray-400">
                            查看賽事詳情 <i class="fas fa-chevron-right ml-2 text-xs"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 已結束比賽 2 -->
            <div class="match-card rounded-xl overflow-hidden">
                <div class="bg-gradient-to-r from-gray-700/10 to-gray-600/10 border-b border-gray-700/30 px-6 py-3">
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-400">NBA · 例行賽 · 已結束</span>
                        <span class="text-xs text-gray-600">3 小時前</span>
                    </div>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-[1fr,auto,1fr] gap-6 items-center">
                        <div class="flex items-center space-x-4">
                            <img src="https://via.placeholder.com/60" alt="Bucks" class="w-14 h-14 rounded-lg border-2 border-gray-800">
                            <div class="flex-1">
                                <h3 class="text-base font-bold">密爾瓦基公鹿</h3>
                                <p class="text-xs text-gray-600">Bucks</p>
                            </div>
                        </div>
                        <div class="text-center px-6">
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl font-bold text-gray-300">128</span>
                                <span class="text-gray-700">-</span>
                                <span class="text-2xl font-bold text-gray-500">119</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4 justify-end">
                            <div class="flex-1 text-right">
                                <h3 class="text-base font-bold text-gray-400">費城76人</h3>
                                <p class="text-xs text-gray-600">76ers</p>
                            </div>
                            <img src="https://via.placeholder.com/60" alt="76ers" class="w-14 h-14 rounded-lg border-2 border-gray-800 opacity-60">
                        </div>
                    </div>
                    <div class="mt-6">
                        <button class="w-full bg-gray-800 hover:bg-gray-700 py-2.5 rounded-lg font-semibold transition text-sm text-gray-400">
                            查看賽事詳情 <i class="fas fa-chevron-right ml-2 text-xs"></i>
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <!-- 賽事詳情模態框 -->
    <div id="matchDetailModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="bg-gray-900 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-700">
            <!-- 模態框標題 -->
            <div class="sticky top-0 bg-gradient-to-r from-purple-600 to-pink-600 px-6 py-4 flex items-center justify-between z-10">
                <h2 class="text-xl font-bold">賽事詳情</h2>
                <button onclick="closeMatchDetail()" class="hover:bg-white/20 p-2 rounded-lg transition">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- 詳情內容 -->
            <div id="matchDetailContent" class="p-6">
                <!-- 動態載入內容 -->
            </div>
        </div>
    </div>

    <!-- Box Score 詳情彈窗 -->
    <div id="boxScoreModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="bg-gray-900 rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto border border-gray-700">
            <!-- 模態框標題 -->
            <div class="sticky top-0 bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4 flex items-center justify-between z-10">
                <h2 class="text-xl font-bold flex items-center">
                    <i class="fas fa-chart-bar mr-3"></i>
                    賽事詳細數據
                </h2>
                <button onclick="closeBoxScore()" class="hover:bg-white/20 p-2 rounded-lg transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <!-- 詳情內容 -->
            <div id="boxScoreContent" class="p-6">
                <!-- 動態載入內容 -->
            </div>
        </div>
    </div>

    <script>
        // 全局變量
        let allGamesData = {}; // 存儲所有日期的比賽資料
        let currentDateIndex = 2; // 當前選中的日期索引 (0-4, 預設為基準日)
        let datesInfo = []; // 日期資訊陣列

        // 頁面載入時獲取比賽資料
        document.addEventListener('DOMContentLoaded', function() {
            fetchNBAGames();
        });

        // 獲取 NBA 比賽資料
        async function fetchNBAGames() {
            try {
                // 計算基準日期 (前一天)
                const baseDate = new Date();
                baseDate.setDate(baseDate.getDate() - 1);
                const baseDateStr = baseDate.toISOString().split('T')[0];

                const response = await fetch(`/api/nba_games?base_date=${baseDateStr}`);
                const data = await response.json();

                if (data.success) {
                    datesInfo = data.dates;
                    allGamesData = data.games;

                    // 更新日期選擇器
                    updateDateSelector();

                    // 渲染比賽列表
                    renderMatches();
                } else {
                    console.error('Failed to fetch NBA games:', data.error);
                    showErrorMessage('無法載入比賽資料');
                }
            } catch (error) {
                console.error('Error fetching NBA games:', error);
                showErrorMessage('網路連線錯誤');
            }
        }

        // 更新日期選擇器
        function updateDateSelector() {
            const dateContainer = document.querySelector('.flex.space-x-1');
            dateContainer.innerHTML = datesInfo.map((dateInfo, index) => `
                <button
                    onclick="selectDate(${index})"
                    class="date-btn px-4 py-2 text-sm ${index === 2 ? 'bg-purple-600 font-semibold' : 'text-gray-400 hover:text-white hover:bg-gray-800'} rounded-lg transition"
                >
                    ${dateInfo.display} ${dateInfo.weekday}${dateInfo.is_base ? ' (基準日)' : ''}
                </button>
            `).join('');
        }

        // 顯示錯誤訊息
        function showErrorMessage(message) {
            const container = document.querySelector('.space-y-3');
            container.innerHTML = `
                <div class="bg-red-900/20 border border-red-500/30 rounded-xl p-8 text-center">
                    <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
                    <p class="text-lg text-red-400">${message}</p>
                    <button onclick="fetchNBAGames()" class="mt-4 bg-red-600 hover:bg-red-700 px-6 py-2 rounded-lg transition">
                        重新載入
                    </button>
                </div>
            `;
        }

        // 模擬賽事數據 (備用)
        const matchesData = {
            live: [
                {
                    id: 1,
                    league: 'NBA · 例行賽',
                    status: 'live',
                    quarter: 'Q4',
                    time: '02:34',
                    homeTeam: { name: '洛杉磯湖人', shortName: 'Lakers', logo: 'https://via.placeholder.com/60', score: 108 },
                    awayTeam: { name: '金州勇士', shortName: 'Warriors', logo: 'https://via.placeholder.com/60', score: 105 },
                    quarterScores: [
                        { quarter: 'Q1', home: 28, away: 25 },
                        { quarter: 'Q2', home: 26, away: 28 },
                        { quarter: 'Q3', home: 27, away: 24 },
                        { quarter: 'Q4', home: 27, away: 28 }
                    ],
                    homePlayers: [
                        { name: 'LeBron James', number: '6', points: 28, rebounds: 8, assists: 7, fg: '11/18' },
                        { name: 'Anthony Davis', number: '3', points: 24, rebounds: 12, assists: 3, fg: '9/15' },
                        { name: 'D\'Angelo Russell', number: '1', points: 18, rebounds: 2, assists: 6, fg: '7/14' },
                        { name: 'Austin Reaves', number: '15', points: 14, rebounds: 4, assists: 5, fg: '5/10' },
                        { name: 'Rui Hachimura', number: '28', points: 12, rebounds: 5, assists: 1, fg: '5/8' }
                    ],
                    awayPlayers: [
                        { name: 'Stephen Curry', number: '30', points: 32, rebounds: 4, assists: 6, fg: '12/22' },
                        { name: 'Klay Thompson', number: '11', points: 21, rebounds: 3, assists: 2, fg: '8/16' },
                        { name: 'Andrew Wiggins', number: '22', points: 16, rebounds: 6, assists: 3, fg: '6/12' },
                        { name: 'Draymond Green', number: '23', points: 8, rebounds: 9, assists: 8, fg: '3/6' },
                        { name: 'Kevon Looney', number: '5', points: 6, rebounds: 11, assists: 2, fg: '3/5' }
                    ]
                },
                {
                    id: 2,
                    league: 'NBA · 例行賽',
                    status: 'live',
                    quarter: 'Q3',
                    time: '08:12',
                    homeTeam: { name: '波士頓塞爾提克', shortName: 'Celtics', logo: 'https://via.placeholder.com/60', score: 95 },
                    awayTeam: { name: '邁阿密熱火', shortName: 'Heat', logo: 'https://via.placeholder.com/60', score: 89 },
                    quarterScores: [
                        { quarter: 'Q1', home: 30, away: 28 },
                        { quarter: 'Q2', home: 24, away: 26 },
                        { quarter: 'Q3', home: 21, away: 19 },
                        { quarter: 'Q4', home: 20, away: 16 }
                    ],
                    homePlayers: [
                        { name: 'Jayson Tatum', number: '0', points: 26, rebounds: 7, assists: 5, fg: '10/18' },
                        { name: 'Jaylen Brown', number: '7', points: 22, rebounds: 5, assists: 4, fg: '9/16' },
                        { name: 'Kristaps Porzingis', number: '8', points: 18, rebounds: 9, assists: 2, fg: '7/13' },
                        { name: 'Derrick White', number: '9', points: 15, rebounds: 3, assists: 6, fg: '6/11' },
                        { name: 'Jrue Holiday', number: '4', points: 14, rebounds: 4, assists: 7, fg: '5/9' }
                    ],
                    awayPlayers: [
                        { name: 'Jimmy Butler', number: '22', points: 24, rebounds: 6, assists: 5, fg: '9/17' },
                        { name: 'Bam Adebayo', number: '13', points: 20, rebounds: 10, assists: 4, fg: '8/14' },
                        { name: 'Tyler Herro', number: '14', points: 18, rebounds: 3, assists: 6, fg: '7/15' },
                        { name: 'Kyle Lowry', number: '7', points: 12, rebounds: 2, assists: 8, fg: '4/10' },
                        { name: 'Caleb Martin', number: '16', points: 15, rebounds: 5, assists: 2, fg: '6/11' }
                    ]
                }
            ],
            upcoming: [
                {
                    id: 3,
                    league: 'NBA · 例行賽',
                    status: 'upcoming',
                    startTime: '19:30',
                    countdown: '45 分鐘後',
                    homeTeam: { name: '布魯克林籃網', shortName: 'Nets', logo: 'https://via.placeholder.com/60' },
                    awayTeam: { name: '芝加哥公牛', shortName: 'Bulls', logo: 'https://via.placeholder.com/60' }
                }
            ],
            finished: [
                {
                    id: 4,
                    league: 'NBA · 例行賽',
                    status: 'finished',
                    timeAgo: '2 小時前',
                    homeTeam: { name: '洛杉磯快艇', shortName: 'Clippers', logo: 'https://via.placeholder.com/60', score: 112 },
                    awayTeam: { name: '丹佛金塊', shortName: 'Nuggets', logo: 'https://via.placeholder.com/60', score: 118 },
                    quarterScores: [
                        { quarter: 'Q1', home: 28, away: 30 },
                        { quarter: 'Q2', home: 26, away: 29 },
                        { quarter: 'Q3', home: 30, away: 28 },
                        { quarter: 'Q4', home: 28, away: 31 }
                    ],
                    homePlayers: [
                        { name: 'Paul George', number: '13', points: 28, rebounds: 6, assists: 5, fg: '10/19' },
                        { name: 'Kawhi Leonard', number: '2', points: 26, rebounds: 7, assists: 4, fg: '9/17' },
                        { name: 'Russell Westbrook', number: '0', points: 20, rebounds: 8, assists: 10, fg: '7/16' },
                        { name: 'Ivica Zubac', number: '40', points: 14, rebounds: 12, assists: 2, fg: '6/9' },
                        { name: 'Norman Powell', number: '24', points: 16, rebounds: 3, assists: 3, fg: '6/12' }
                    ],
                    awayPlayers: [
                        { name: 'Nikola Jokic', number: '15', points: 35, rebounds: 14, assists: 12, fg: '14/22' },
                        { name: 'Jamal Murray', number: '27', points: 28, rebounds: 5, assists: 8, fg: '11/20' },
                        { name: 'Michael Porter Jr.', number: '1', points: 22, rebounds: 9, assists: 2, fg: '8/15' },
                        { name: 'Aaron Gordon', number: '50', points: 16, rebounds: 7, assists: 4, fg: '6/11' },
                        { name: 'Kentavious Caldwell-Pope', number: '5', points: 12, rebounds: 3, assists: 3, fg: '4/8' }
                    ]
                },
                {
                    id: 5,
                    league: 'NBA · 例行賽',
                    status: 'finished',
                    timeAgo: '3 小時前',
                    homeTeam: { name: '密爾瓦基公鹿', shortName: 'Bucks', logo: 'https://via.placeholder.com/60', score: 128 },
                    awayTeam: { name: '費城76人', shortName: '76ers', logo: 'https://via.placeholder.com/60', score: 119 },
                    quarterScores: [
                        { quarter: 'Q1', home: 32, away: 28 },
                        { quarter: 'Q2', home: 30, away: 32 },
                        { quarter: 'Q3', home: 34, away: 30 },
                        { quarter: 'Q4', home: 32, away: 29 }
                    ],
                    homePlayers: [
                        { name: 'Giannis Antetokounmpo', number: '34', points: 38, rebounds: 15, assists: 8, fg: '15/24' },
                        { name: 'Damian Lillard', number: '0', points: 32, rebounds: 4, assists: 10, fg: '12/21' },
                        { name: 'Khris Middleton', number: '22', points: 22, rebounds: 6, assists: 6, fg: '8/16' },
                        { name: 'Brook Lopez', number: '11', points: 16, rebounds: 8, assists: 2, fg: '6/11' },
                        { name: 'Bobby Portis', number: '9', points: 14, rebounds: 9, assists: 1, fg: '5/10' }
                    ],
                    awayPlayers: [
                        { name: 'Joel Embiid', number: '21', points: 34, rebounds: 12, assists: 5, fg: '13/25' },
                        { name: 'Tyrese Maxey', number: '0', points: 28, rebounds: 3, assists: 7, fg: '11/19' },
                        { name: 'Tobias Harris', number: '12', points: 20, rebounds: 7, assists: 3, fg: '8/15' },
                        { name: 'De\'Anthony Melton', number: '8', points: 15, rebounds: 4, assists: 4, fg: '6/12' },
                        { name: 'Paul Reed', number: '44', points: 12, rebounds: 8, assists: 2, fg: '5/8' }
                    ]
                }
            ]
        };

        let currentTab = 'all'; // 當前標籤頁

        // 直接選擇日期
        function selectDate(index) {
            currentDateIndex = index;
            const dateButtons = document.querySelectorAll('.date-btn');
            dateButtons.forEach((btn, i) => {
                if (i === index) {
                    btn.classList.add('bg-purple-600', 'font-semibold');
                    btn.classList.remove('text-gray-400', 'hover:text-white', 'hover:bg-gray-800');
                } else {
                    btn.classList.remove('bg-purple-600', 'font-semibold');
                    btn.classList.add('text-gray-400', 'hover:text-white', 'hover:bg-gray-800');
                }
            });
            renderMatches();
        }

        // 日期切換（箭頭）
        function changeDate(direction) {
            const dateButtons = document.querySelectorAll('.date-btn');
            let currentIndex = Array.from(dateButtons).findIndex(btn => btn.classList.contains('bg-purple-600'));

            if (direction === 'prev' && currentIndex > 0) {
                currentIndex--;
            } else if (direction === 'next' && currentIndex < dateButtons.length - 1) {
                currentIndex++;
            }

            dateButtons.forEach((btn, index) => {
                if (index === currentIndex) {
                    btn.classList.add('bg-purple-600', 'font-semibold');
                    btn.classList.remove('text-gray-400', 'hover:text-white', 'hover:bg-gray-800');
                } else {
                    btn.classList.remove('bg-purple-600', 'font-semibold');
                    btn.classList.add('text-gray-400', 'hover:text-white', 'hover:bg-gray-800');
                }
            });

            renderMatches();
        }

        // 標籤頁切換
        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            renderMatches();
        }

        // 渲染賽事列表
        function renderMatches() {
            const container = document.querySelector('.space-y-3');

            // 獲取當前選中日期的比賽
            if (!datesInfo[currentDateIndex]) {
                container.innerHTML = '<p class="text-center text-gray-400">載入中...</p>';
                return;
            }

            const currentDate = datesInfo[currentDateIndex].date;
            const todayGames = allGamesData[currentDate] || [];

            // 根據標籤頁過濾比賽
            let matches = [];
            if (currentTab === 'all') {
                matches = todayGames;
            } else {
                matches = todayGames.filter(game => game.status === currentTab);
            }

            // 更新標籤頁計數
            updateTabCounts(todayGames);

            if (matches.length === 0) {
                container.innerHTML = `
                    <div class="bg-gray-800/30 border border-gray-700/50 rounded-xl p-12 text-center">
                        <i class="fas fa-calendar-times text-gray-600 text-5xl mb-4"></i>
                        <p class="text-xl text-gray-400">此日期沒有比賽</p>
                        <p class="text-sm text-gray-500 mt-2">請選擇其他日期查看賽事</p>
                    </div>
                `;
            } else {
                container.innerHTML = matches.map(match => generateMatchCard(match)).join('');
            }
        }

        // 更新標籤頁計數
        function updateTabCounts(games) {
            const liveCount = games.filter(g => g.status === 'live').length;
            const upcomingCount = games.filter(g => g.status === 'upcoming').length;
            const finishedCount = games.filter(g => g.status === 'finished').length;

            const tabs = document.querySelectorAll('.tab-button');
            tabs.forEach(tab => {
                const text = tab.textContent;
                if (text.includes('進行中')) {
                    tab.innerHTML = `<span class="bg-red-500 w-2 h-2 rounded-full inline-block mr-2 live-dot"></span>進行中 <span class="ml-1 text-xs">(${liveCount})</span>`;
                } else if (text.includes('即將開始')) {
                    tab.innerHTML = `即將開始 <span class="ml-1 text-xs">(${upcomingCount})</span>`;
                } else if (text.includes('已結束')) {
                    tab.innerHTML = `已結束 <span class="ml-1 text-xs">(${finishedCount})</span>`;
                }
            });
        }

        // 生成賽事卡片
        function generateMatchCard(match) {
            const league = 'NBA · 例行賽';

            if (match.status === 'live') {
                return `
                    <div class="match-card rounded-xl overflow-hidden">
                        <div class="bg-gradient-to-r from-red-600/20 to-orange-600/20 border-b border-red-500/30 px-6 py-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <span class="bg-red-500 text-white text-xs px-2.5 py-1 rounded font-bold live-badge">LIVE</span>
                                    <span class="text-sm text-gray-300">${league}</span>
                                </div>
                                <span class="text-sm font-mono text-red-400 font-bold">${match.quarter} ${match.time}</span>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="grid grid-cols-[1fr,auto,1fr] gap-6 items-center">
                                <div class="flex items-center space-x-4">
                                    <img src="${match.homeTeam.logo}" alt="${match.homeTeam.short}" class="w-14 h-14 rounded-lg border-2 border-gray-700" onerror="this.src='https://via.placeholder.com/60'">
                                    <div class="flex-1">
                                        <h3 class="text-lg font-bold">${match.homeTeam.name}</h3>
                                        <p class="text-xs text-gray-500">${match.homeTeam.short}</p>
                                    </div>
                                </div>
                                <div class="text-center px-6">
                                    <div class="flex items-center space-x-4">
                                        <span class="text-4xl font-black ${match.homeScore > match.awayScore ? 'score-gradient' : 'text-gray-400'}">${match.homeScore}</span>
                                        <span class="text-2xl text-gray-600 font-light">:</span>
                                        <span class="text-4xl font-black ${match.awayScore > match.homeScore ? 'score-gradient' : 'text-gray-400'}">${match.awayScore}</span>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4 justify-end">
                                    <div class="flex-1 text-right">
                                        <h3 class="text-lg font-bold">${match.awayTeam.name}</h3>
                                        <p class="text-xs text-gray-500">${match.awayTeam.short}</p>
                                    </div>
                                    <img src="${match.awayTeam.logo}" alt="${match.awayTeam.short}" class="w-14 h-14 rounded-lg border-2 border-gray-700" onerror="this.src='https://via.placeholder.com/60'">
                                </div>
                            </div>
                            <div class="mt-6">
                                <button class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 py-3 rounded-lg font-semibold transition flex items-center justify-center space-x-2 opacity-50 cursor-not-allowed">
                                    <i class="fas fa-play-circle"></i>
                                    <span>觀看直播</span>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            } else if (match.status === 'upcoming') {
                return `
                    <div class="match-card rounded-xl overflow-hidden">
                        <div class="bg-gradient-to-r from-blue-600/10 to-cyan-600/10 border-b border-blue-500/20 px-6 py-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <span class="bg-blue-600 text-white text-xs px-2.5 py-1 rounded font-bold">
                                        <i class="fas fa-clock mr-1"></i>${match.startTime}
                                    </span>
                                    <span class="text-sm text-gray-300">${league}</span>
                                </div>
                                <span class="text-xs text-gray-500">${match.countdown}</span>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="grid grid-cols-[1fr,auto,1fr] gap-6 items-center">
                                <div class="flex items-center space-x-4">
                                    <img src="${match.homeTeam.logo}" alt="${match.homeTeam.short}" class="w-14 h-14 rounded-lg border-2 border-gray-700 opacity-80" onerror="this.src='https://via.placeholder.com/60'">
                                    <div class="flex-1">
                                        <h3 class="text-lg font-bold">${match.homeTeam.name}</h3>
                                        <p class="text-xs text-gray-500">${match.homeTeam.short}</p>
                                    </div>
                                </div>
                                <div class="text-center px-6">
                                    <span class="text-2xl text-gray-600 font-bold">VS</span>
                                </div>
                                <div class="flex items-center space-x-4 justify-end">
                                    <div class="flex-1 text-right">
                                        <h3 class="text-lg font-bold">${match.awayTeam.name}</h3>
                                        <p class="text-xs text-gray-500">${match.awayTeam.short}</p>
                                    </div>
                                    <img src="${match.awayTeam.logo}" alt="${match.awayTeam.short}" class="w-14 h-14 rounded-lg border-2 border-gray-700 opacity-80" onerror="this.src='https://via.placeholder.com/60'">
                                </div>
                            </div>
                            <div class="mt-6">
                                <button class="w-full bg-gray-800 hover:bg-gray-700 py-3 rounded-lg font-semibold transition text-gray-300">
                                    設定提醒 <i class="fas fa-bell ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                return `
                    <div class="match-card rounded-xl overflow-hidden">
                        <div class="bg-gradient-to-r from-gray-700/10 to-gray-600/10 border-b border-gray-700/30 px-6 py-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-400">${league} · 已結束</span>
                                <span class="text-xs text-gray-600">${match.timeAgo || ''}</span>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="grid grid-cols-[1fr,auto,1fr] gap-6 items-center">
                                <div class="flex items-center space-x-4">
                                    <img src="${match.homeTeam.logo}" alt="${match.homeTeam.short}" class="w-14 h-14 rounded-lg border-2 border-gray-800 ${match.homeScore < match.awayScore ? 'opacity-60' : ''}" onerror="this.src='https://via.placeholder.com/60'">
                                    <div class="flex-1">
                                        <h3 class="text-base font-bold ${match.homeScore < match.awayScore ? 'text-gray-400' : ''}">${match.homeTeam.name}</h3>
                                        <p class="text-xs text-gray-600">${match.homeTeam.short}</p>
                                    </div>
                                </div>
                                <div class="text-center px-6">
                                    <div class="flex items-center space-x-3">
                                        <span class="text-2xl font-bold ${match.homeScore > match.awayScore ? 'text-gray-300' : 'text-gray-500'}">${match.homeScore}</span>
                                        <span class="text-gray-700">-</span>
                                        <span class="text-2xl font-bold ${match.awayScore > match.homeScore ? 'text-gray-300' : 'text-gray-500'}">${match.awayScore}</span>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4 justify-end">
                                    <div class="flex-1 text-right">
                                        <h3 class="text-base font-bold ${match.awayScore < match.homeScore ? 'text-gray-400' : ''}">${match.awayTeam.name}</h3>
                                        <p class="text-xs text-gray-600">${match.awayTeam.short}</p>
                                    </div>
                                    <img src="${match.awayTeam.logo}" alt="${match.awayTeam.short}" class="w-14 h-14 rounded-lg border-2 border-gray-800 ${match.awayScore < match.homeScore ? 'opacity-60' : ''}" onerror="this.src='https://via.placeholder.com/60'">
                                </div>
                            </div>
                            <div class="mt-6">
                                <button onclick="showBoxScore('${match.id}', '${match.awayTeam.short}', '${match.homeTeam.short}')" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 py-3 rounded-lg font-semibold transition flex items-center justify-center space-x-2">
                                    <i class="fas fa-chart-bar"></i>
                                    <span>賽事詳情</span>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // 顯示賽事詳情
        function showMatchDetail(matchId) {
            const allMatches = [...matchesData.live, ...matchesData.upcoming, ...matchesData.finished];
            const match = allMatches.find(m => m.id === matchId);

            if (!match || match.status === 'upcoming') return;

            const modal = document.getElementById('matchDetailModal');
            const content = document.getElementById('matchDetailContent');

            content.innerHTML = `
                <!-- 賽事概況 -->
                <div class="bg-gradient-to-r from-purple-600/20 to-pink-600/20 rounded-xl p-6 mb-6 border border-purple-500/30">
                    <div class="text-center mb-6">
                        <p class="text-sm text-gray-400 mb-2">${match.league} ${match.status === 'live' ? '· ' + match.quarter + ' ' + match.time : '· 已結束'}</p>
                        <div class="flex items-center justify-center space-x-8">
                            <div class="text-center">
                                <img src="${match.homeTeam.logo}" alt="${match.homeTeam.shortName}" class="w-20 h-20 mx-auto mb-2 rounded-xl">
                                <h3 class="text-xl font-bold">${match.homeTeam.name}</h3>
                            </div>
                            <div class="text-center">
                                <div class="text-5xl font-black score-gradient">${match.homeTeam.score} - ${match.awayTeam.score}</div>
                            </div>
                            <div class="text-center">
                                <img src="${match.awayTeam.logo}" alt="${match.awayTeam.shortName}" class="w-20 h-20 mx-auto mb-2 rounded-xl">
                                <h3 class="text-xl font-bold">${match.awayTeam.name}</h3>
                            </div>
                        </div>
                    </div>

                    <!-- 各節比分 -->
                    <div class="grid grid-cols-5 gap-3 text-center text-sm bg-gray-800/50 rounded-lg p-4">
                        ${match.quarterScores.map(q => `
                            <div>
                                <div class="text-xs text-gray-500 mb-2">${q.quarter}</div>
                                <div class="font-semibold">${q.home} - ${q.away}</div>
                            </div>
                        `).join('')}
                        <div>
                            <div class="text-xs text-gray-500 mb-2">總分</div>
                            <div class="font-bold score-gradient">${match.homeTeam.score} - ${match.awayTeam.score}</div>
                        </div>
                    </div>
                </div>

                <!-- 球員數據對比 -->
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- 主隊球員 -->
                    <div>
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <img src="${match.homeTeam.logo}" alt="${match.homeTeam.shortName}" class="w-8 h-8 mr-2 rounded">
                            ${match.homeTeam.name} 球員數據
                        </h3>
                        <div class="space-y-2">
                            <div class="grid grid-cols-6 gap-2 text-xs text-gray-500 px-3 pb-2 border-b border-gray-700">
                                <div class="col-span-2">球員</div>
                                <div class="text-center">得分</div>
                                <div class="text-center">籃板</div>
                                <div class="text-center">助攻</div>
                                <div class="text-center">命中率</div>
                            </div>
                            ${match.homePlayers.map(player => `
                                <div class="grid grid-cols-6 gap-2 items-center bg-gray-800/50 rounded-lg p-3 hover:bg-gray-800 transition">
                                    <div class="col-span-2">
                                        <div class="font-semibold text-sm">${player.name}</div>
                                        <div class="text-xs text-gray-500">#${player.number}</div>
                                    </div>
                                    <div class="text-center font-bold text-yellow-400">${player.points}</div>
                                    <div class="text-center">${player.rebounds}</div>
                                    <div class="text-center">${player.assists}</div>
                                    <div class="text-center text-xs">${player.fg}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- 客隊球員 -->
                    <div>
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <img src="${match.awayTeam.logo}" alt="${match.awayTeam.shortName}" class="w-8 h-8 mr-2 rounded">
                            ${match.awayTeam.name} 球員數據
                        </h3>
                        <div class="space-y-2">
                            <div class="grid grid-cols-6 gap-2 text-xs text-gray-500 px-3 pb-2 border-b border-gray-700">
                                <div class="col-span-2">球員</div>
                                <div class="text-center">得分</div>
                                <div class="text-center">籃板</div>
                                <div class="text-center">助攻</div>
                                <div class="text-center">命中率</div>
                            </div>
                            ${match.awayPlayers.map(player => `
                                <div class="grid grid-cols-6 gap-2 items-center bg-gray-800/50 rounded-lg p-3 hover:bg-gray-800 transition">
                                    <div class="col-span-2">
                                        <div class="font-semibold text-sm">${player.name}</div>
                                        <div class="text-xs text-gray-500">#${player.number}</div>
                                    </div>
                                    <div class="text-center font-bold text-yellow-400">${player.points}</div>
                                    <div class="text-center">${player.rebounds}</div>
                                    <div class="text-center">${player.assists}</div>
                                    <div class="text-center text-xs">${player.fg}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>

                <!-- 團隊統計 -->
                <div class="mt-6 bg-gray-800/50 rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4">團隊統計對比</h3>
                    <div class="grid grid-cols-3 gap-6">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-400">${match.homePlayers.reduce((sum, p) => sum + p.points, 0)}</div>
                            <div class="text-sm text-gray-400 mt-1">總得分</div>
                            <div class="text-2xl font-bold text-pink-400 mt-2">${match.awayPlayers.reduce((sum, p) => sum + p.points, 0)}</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-400">${match.homePlayers.reduce((sum, p) => sum + p.rebounds, 0)}</div>
                            <div class="text-sm text-gray-400 mt-1">總籃板</div>
                            <div class="text-2xl font-bold text-pink-400 mt-2">${match.awayPlayers.reduce((sum, p) => sum + p.rebounds, 0)}</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-400">${match.homePlayers.reduce((sum, p) => sum + p.assists, 0)}</div>
                            <div class="text-sm text-gray-400 mt-1">總助攻</div>
                            <div class="text-2xl font-bold text-pink-400 mt-2">${match.awayPlayers.reduce((sum, p) => sum + p.assists, 0)}</div>
                        </div>
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // 關閉詳情
        function closeMatchDetail() {
            const modal = document.getElementById('matchDetailModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // 顯示比賽詳情 (暫時禁用,因為缺少詳細數據)
        function showMatchDetail(matchId) {
            alert('比賽詳情功能開發中');
        }

        // 顯示 Box Score 賽事詳情
        async function showBoxScore(gameId, awayCode, homeCode) {
            const modal = document.getElementById('boxScoreModal');
            const content = document.getElementById('boxScoreContent');

            // 顯示載入中
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            content.innerHTML = `
                <div class="text-center py-12">
                    <i class="fas fa-spinner fa-spin text-4xl text-blue-500 mb-4"></i>
                    <p class="text-gray-400">載入賽事資料中...</p>
                </div>
            `;

            try {
                const response = await fetch(`/api/box_score?game_id=${gameId}&away_code=${awayCode}&home_code=${homeCode}`);
                const result = await response.json();

                if (!result.success) {
                    throw new Error(result.error || '無法獲取資料');
                }

                const data = result.data;

                // 產生球員統計表格
                const generatePlayerStats = (players) => {
                    if (!players || players.length === 0) {
                        return '<p class="text-gray-500 text-center py-4">無球員數據</p>';
                    }

                    return `
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-800/50 text-gray-400 text-xs">
                                    <tr>
                                        <th class="text-left py-3 px-4">球員</th>
                                        <th class="text-center py-3 px-2">MIN</th>
                                        <th class="text-center py-3 px-2">PTS</th>
                                        <th class="text-center py-3 px-2">REB</th>
                                        <th class="text-center py-3 px-2">AST</th>
                                        <th class="text-center py-3 px-2">FG</th>
                                        <th class="text-center py-3 px-2">3PT</th>
                                        <th class="text-center py-3 px-2">FT</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300">
                                    ${players.filter(p => p.hasPlayed).map(player => {
                                        const stats = player.statistics;
                                        return `
                                        <tr class="border-t border-gray-800 hover:bg-gray-800/30">
                                            <td class="py-3 px-4">
                                                <div class="flex items-center space-x-2">
                                                    <span class="font-semibold">${player.nameI || player.name}</span>
                                                    ${player.jerseyNum ? `<span class="text-xs text-gray-500">#${player.jerseyNum}</span>` : ''}
                                                    ${player.position ? `<span class="text-xs text-gray-600">${player.position}</span>` : ''}
                                                </div>
                                            </td>
                                            <td class="text-center py-3 px-2">${stats.minutes || '0:00'}</td>
                                            <td class="text-center py-3 px-2 font-bold text-yellow-400">${stats.points || '0'}</td>
                                            <td class="text-center py-3 px-2">${stats.reboundsTotal || '0'}</td>
                                            <td class="text-center py-3 px-2">${stats.assists || '0'}</td>
                                            <td class="text-center py-3 px-2 text-xs">${stats.fieldGoalsMade || '0'}/${stats.fieldGoalsAttempted || '0'}</td>
                                            <td class="text-center py-3 px-2 text-xs">${stats.threePointersMade || '0'}/${stats.threePointersAttempted || '0'}</td>
                                            <td class="text-center py-3 px-2 text-xs">${stats.freeThrowsMade || '0'}/${stats.freeThrowsAttempted || '0'}</td>
                                        </tr>
                                    `}).join('')}
                                </tbody>
                            </table>
                        </div>
                    `;
                };

                // 產生各節比分
                const generatePeriodScores = () => {
                    if (!data.periods || data.periods.length === 0) {
                        return '';
                    }

                    return `
                        <div class="mb-6 bg-gray-800/50 rounded-lg p-4">
                            <h4 class="text-sm text-gray-400 mb-3 font-semibold">各節比分</h4>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm text-center">
                                    <thead>
                                        <tr class="text-gray-500 text-xs">
                                            <th class="py-2 px-3 text-left">隊伍</th>
                                            ${data.periods.map(p => `<th class="py-2 px-3">${p.period === 5 ? 'OT' : 'Q' + p.period}</th>`).join('')}
                                            <th class="py-2 px-3 font-bold">總分</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-t border-gray-700">
                                            <td class="py-3 px-3 text-left font-semibold">${data.awayTeam.name}</td>
                                            ${data.periods.map(p => `<td class="py-3 px-3">${p.awayScore || '0'}</td>`).join('')}
                                            <td class="py-3 px-3 font-bold text-blue-400">${data.awayTeam.score}</td>
                                        </tr>
                                        <tr class="border-t border-gray-700">
                                            <td class="py-3 px-3 text-left font-semibold">${data.homeTeam.name}</td>
                                            ${data.periods.map(p => `<td class="py-3 px-3">${p.homeScore || '0'}</td>`).join('')}
                                            <td class="py-3 px-3 font-bold text-purple-400">${data.homeTeam.score}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                };

                content.innerHTML = `
                    <!-- 比賽標題 -->
                    <div class="bg-gradient-to-r from-blue-600/20 to-purple-600/20 rounded-xl p-6 mb-6 border border-blue-500/30">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-4">
                                <h3 class="text-2xl font-bold">${data.awayTeam.name}</h3>
                                <span class="text-3xl font-black text-blue-400">${data.awayTeam.score}</span>
                            </div>
                            <span class="text-gray-500 text-xl">@</span>
                            <div class="flex items-center space-x-4">
                                <span class="text-3xl font-black text-purple-400">${data.homeTeam.score}</span>
                                <h3 class="text-2xl font-bold">${data.homeTeam.name}</h3>
                            </div>
                        </div>
                        ${generatePeriodScores()}
                    </div>

                    <!-- 客隊球員統計 -->
                    <div class="mb-6">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <span class="bg-blue-600 w-1 h-6 mr-3 rounded"></span>
                            ${data.awayTeam.name} 球員統計
                        </h3>
                        ${generatePlayerStats(data.awayTeam.players)}
                    </div>

                    <!-- 主隊球員統計 -->
                    <div class="mb-6">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <span class="bg-purple-600 w-1 h-6 mr-3 rounded"></span>
                            ${data.homeTeam.name} 球員統計
                        </h3>
                        ${generatePlayerStats(data.homeTeam.players)}
                    </div>
                `;

            } catch (error) {
                content.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-exclamation-circle text-4xl text-red-500 mb-4"></i>
                        <p class="text-gray-400 mb-2">無法載入賽事資料</p>
                        <p class="text-sm text-gray-600">${error.message}</p>
                    </div>
                `;
            }
        }

        // 關閉 Box Score 彈窗
        function closeBoxScore() {
            const modal = document.getElementById('boxScoreModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }
    </script>
</body>
</html>
